<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Practical Machine Learning Course by anonymous-1618</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Practical Machine Learning Course</h1>
      <h2 class="project-tagline">Project Assigment</h2>
      <a href="https://github.com/anonymous-1618/ML" class="btn">View on GitHub</a>
      <a href="https://github.com/anonymous-1618/ML/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/anonymous-1618/ML/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="how-well-are-we-doing-our-physical-exercise" class="anchor" href="#how-well-are-we-doing-our-physical-exercise" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How well are we doing our Physical exercise?</h1>

<hr>

<h3>
<a id="summary" class="anchor" href="#summary" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Summary:</h3>

<p>Nowadays, to improve the quality of life  more and more people are practising sports.Practice not only improves the body's physical condition or fitness but also decreases the likelihood of many ills related to a sedentary life style, such as heart disease. But, it is not only the act or quantity of doing physical exercise that matters. Many people usually forget that physical exercise when done in the wrong way, may be less effective. But on the other hand they can also be very damaging causing undesirable injuries. Therefore, the right way to perform the exercise is considered a top priority.
This project is based on the work made by Veloso <em>et al.</em> "Qualitative Activity Recognition of Weight Lifting Exercises". The authors mounted sensors in six male volunteers to lift a relatively light dumbbell (1.25kg) weight. Five different ways (where only one is correct) to perform the lifting exercise were monitored by the sensors. The data collected were analysed and a machine learning model was built to assess the correctness and feedback to the user in real-time; increasing the likelihood of the exercise effectiveness. </p>

<h3>
<a id="scope" class="anchor" href="#scope" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Scope:</h3>

<p>As part of the Coursera assessment, the report described here are restricted to answer the followings:</p>

<ul>
<li>  Predict the manner in which the exercise was done.</li>
<li>  Show how cross validation was implemented</li>
<li>  Analyse the sample error.</li>
<li>  Discuss the assumptions made.</li>
<li>  Apply the proposed model to predict 20 different test cases.</li>
</ul>

<h3>
<a id="experiment-description" class="anchor" href="#experiment-description" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Experiment description:</h3>

<p>Six (6) volunteers wore four (4) "9 Degrees of Freedom - Razor IMU". Each one of the Razor IMU is composed of three sensors: accelerometer, gyroscope and magnetometer, each one providing 3 degrees of freedom. Therefore, a total of 9 degrees of freedom per location (see the sketch). The four locations were: glove, armband, lumbar belt and dumbbell.</p>

<p><img src="https://raw.githubusercontent.com/anonymous-1618/ML/master/sketch.png" alt=""></p>

<p>The volunteers were male participants aged between 20-28 years. They performed one set of 10 repetitions of the activity "Unilateral Dumbbell Biceps Curl" in five different "classes", one class is the right way (class A below) and the others the wrong way (classes B to E below):</p>

<ul>
<li>Class A - The right exercise (<em>i.e</em>., exactly according to the specification)</li>
<li>Class B - Throwing the elbows to the front</li>
<li>Class C - Lifting the dumbbell only halfway </li>
<li>Class D - Lowering the dumbbell only halfway</li>
<li>Class E - Throwing the hips to the front</li>
</ul>

<h3>
<a id="exploratory-data-analysis" class="anchor" href="#exploratory-data-analysis" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Exploratory Data analysis:</h3>

<p><strong>1.    Download the data from a provided URL.</strong></p>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">fileUrl</span> <span class="pl-k">&lt;-</span> <span class="pl-s"><span class="pl-pds">"</span>https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv<span class="pl-pds">"</span></span>
    download.file(<span class="pl-smi">fileUrl</span>, <span class="pl-v">destfile</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>./pml-training.csv<span class="pl-pds">"</span></span>)

    <span class="pl-smi">fileUrl</span> <span class="pl-k">&lt;-</span> <span class="pl-s"><span class="pl-pds">"</span>https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv<span class="pl-pds">"</span></span>
    download.file(<span class="pl-smi">fileUrl</span>, <span class="pl-v">destfile</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>./pml-testing.csv<span class="pl-pds">"</span></span>)</pre></div>

<p><strong>2.    Load to R Global environment the files from their respective folders.</strong></p>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">pml.training</span> <span class="pl-k">&lt;-</span> read.csv(<span class="pl-s"><span class="pl-pds">"</span>pml-training.csv<span class="pl-pds">"</span></span>,<span class="pl-v">header</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>, <span class="pl-v">na.strings</span><span class="pl-k">=</span>c(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>NA<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>#DIV/0!<span class="pl-pds">"</span></span>))
    <span class="pl-smi">pml.testing</span>  <span class="pl-k">&lt;-</span> read.csv(<span class="pl-s"><span class="pl-pds">"</span>pml-testing.csv<span class="pl-pds">"</span></span>, <span class="pl-v">header</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>, <span class="pl-v">na.strings</span><span class="pl-k">=</span>c(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>NA<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>#DIV/0!<span class="pl-pds">"</span></span>))</pre></div>

<p><strong>3.    Take a look at the data and analyse the data structure</strong></p>

<div class="highlight highlight-source-r"><pre>str(<span class="pl-smi">pml.training</span>, <span class="pl-v">list.len</span><span class="pl-k">=</span><span class="pl-c1">20</span>)</pre></div>

<div class="highlight highlight-source-r"><pre><span class="pl-s"><span class="pl-pds">'</span>data.frame<span class="pl-pds">'</span></span><span class="pl-k">:</span>   <span class="pl-c1">19622</span> <span class="pl-smi">obs</span>. <span class="pl-smi">of</span>  <span class="pl-c1">160</span> <span class="pl-smi">variables</span><span class="pl-k">:</span>
 <span class="pl-k">$</span> <span class="pl-smi">X</span>                       <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">1</span> <span class="pl-c1">2</span> <span class="pl-c1">3</span> <span class="pl-c1">4</span> <span class="pl-c1">5</span> <span class="pl-c1">6</span> <span class="pl-c1">7</span> <span class="pl-c1">8</span> <span class="pl-c1">9</span> <span class="pl-c1">10</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">user_name</span>               <span class="pl-k">:</span> <span class="pl-smi">Factor</span> <span class="pl-smi">w</span><span class="pl-k">/</span> <span class="pl-c1">6</span> <span class="pl-smi">levels</span> <span class="pl-s"><span class="pl-pds">"</span>adelmo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>carlitos<span class="pl-pds">"</span></span>,..<span class="pl-k">:</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">raw_timestamp_part_1</span>    <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">1323084231</span> <span class="pl-c1">1323084231</span> <span class="pl-c1">1323084231</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">raw_timestamp_part_2</span>    <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">788290</span> <span class="pl-c1">808298</span> <span class="pl-c1">820366</span> <span class="pl-c1">120339</span> <span class="pl-c1">196328</span> <span class="pl-c1">304277</span> <span class="pl-c1">368296</span> <span class="pl-c1">440390</span> <span class="pl-c1">484323</span> <span class="pl-c1">484434</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">cvtd_timestamp</span>          <span class="pl-k">:</span> <span class="pl-smi">Factor</span> <span class="pl-smi">w</span><span class="pl-k">/</span> <span class="pl-c1">20</span> <span class="pl-smi">levels</span> <span class="pl-s"><span class="pl-pds">"</span>02/12/2011 13:32<span class="pl-pds">"</span></span>,..<span class="pl-k">:</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">new_window</span>              <span class="pl-k">:</span> <span class="pl-smi">Factor</span> <span class="pl-smi">w</span><span class="pl-k">/</span> <span class="pl-c1">2</span> <span class="pl-smi">levels</span> <span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">num_window</span>              <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">11</span> <span class="pl-c1">11</span> <span class="pl-c1">11</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">roll_belt</span>               <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">1.41</span> <span class="pl-c1">1.41</span> <span class="pl-c1">1.42</span> <span class="pl-c1">1.48</span> <span class="pl-c1">1.48</span> <span class="pl-c1">1.45</span> <span class="pl-c1">1.42</span> <span class="pl-c1">1.42</span> <span class="pl-c1">1.43</span> <span class="pl-c1">1.45</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">pitch_belt</span>              <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">8.07</span> <span class="pl-c1">8.07</span> <span class="pl-c1">8.07</span> <span class="pl-c1">8.05</span> <span class="pl-c1">8.07</span> <span class="pl-c1">8.06</span> <span class="pl-c1">8.09</span> <span class="pl-c1">8.13</span> <span class="pl-c1">8.16</span> <span class="pl-c1">8.17</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">yaw_belt</span>                <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">total_accel_belt</span>        <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">kurtosis_roll_belt</span>      <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">kurtosis_picth_belt</span>     <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">kurtosis_yaw_belt</span>       <span class="pl-k">:</span> <span class="pl-smi">logi</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">skewness_roll_belt</span>      <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">skewness_roll_belt.1</span>    <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">skewness_yaw_belt</span>       <span class="pl-k">:</span> <span class="pl-smi">logi</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">max_roll_belt</span>           <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">max_picth_belt</span>          <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">max_yaw_belt</span>            <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-c1">NA</span> <span class="pl-k">...</span>
  [<span class="pl-smi">list</span> <span class="pl-smi">output</span> <span class="pl-smi">truncated</span>]</pre></div>

<p>Raw data variables for each sensor per location are recorded as follows:</p>

<ul>
<li>  Triaxial accelerometer:

<ul>
<li>  3 (x,y,z) x 4 (locations) = 12<br>
</li>
</ul>
</li>
<li>  Triaxial gyroscope:

<ul>
<li>  3 (x,y,z) x 4 (locations) = 12<br>
</li>
</ul>
</li>
<li>  Triaxial  magnetometer:

<ul>
<li>  3 (x,y,z) x 4 (locations) = 12<br>
</li>
</ul>
</li>
</ul>

<p>A total of 36 raw data variables were then recorded.</p>

<p>"Fusion" variables obtained from the raw data variables were also recorded:</p>

<ul>
<li>  Three Rotational angles (roll, pitch, yaw) per location:

<ul>
<li>  3  x 4 (locations) = 12</li>
</ul>
</li>
<li>  Total acceleration per location:

<ul>
<li>  1  x 4 (locations) = 4</li>
</ul>
</li>
</ul>

<p>The data from accelerometer, magnetometer and gyroscope are "fused" by using a Direction Cosine Matrix (DCM) algorithm in the Razor IMU, that means a total of 16 "fused" variables are recorded. Furthermore, in some of the "fused" variables, the following <em>descriptive statistics</em> variables ("stat") were recorded:</p>

<ul>
<li>  Max, Min, standard deviation(stddev), variance(var), average(avg) of rotational angles:

<ul>
<li>  5 x 12 = 60<br>
</li>
</ul>
</li>
<li>  Amplitude of rotational angles (amplitude):

<ul>
<li>  3 x 4  = 12</li>
</ul>
</li>
<li>  kurtosis and skewness of rotational angles:

<ul>
<li>  2 x 12 = 24</li>
</ul>
</li>
<li>  variance(var) of total acceleration:

<ul>
<li>  1 x 4  = 4</li>
</ul>
</li>
</ul>

<p>A total of 100 "stat" variables.</p>

<p>The remainder variables:</p>

<ul>
<li>  Volunteer ID (user_name)</li>
<li>  Exercise type (class)</li>
<li>  Index or observable number (X)</li>
<li>  time &amp; date (cvtd_timestamp)</li>
<li>  Four (4) time variables (raw_timestample_part_1 &amp; raw_timestample_part_1, new_window, num_window);</li>
</ul>

<p>A total of 8 remainder variables.
In summary, the experiment recorded a total number of 160 (36 + 16 + 100 + 8) variables.</p>

<p>Each individual performed 5 "classes" of exercises. Each exercise was repeated 10 times. All together a total of 19642 recorded observables were derived, which were then split by Coursera into two files:</p>

<ul>
<li> train set to create the Model loaded as "pml.training" is a dataframe of 19622 x 160 </li>
<li> test set to answer the Quiz loaded as "pml.testing"  is a dataframe of 20 x 160</li>
</ul>

<p><strong>4.  Data Cleaning</strong></p>

<p>The data was cleaned and the variables re-labelled by using <em>CamelCase</em> structure.</p>

<div class="highlight highlight-source-r"><pre>    <span class="pl-v">temp</span><span class="pl-k">=</span>names(<span class="pl-smi">pml.training</span>)
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^a<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^g<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>G<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); 
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^k<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>K<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^m<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>M<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^n<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>N<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^p<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>P<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^r<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>R<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^s<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>S<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^t<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>T<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^u<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>U<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^v<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>V<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^y<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Y<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_a<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_b<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>B<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_d<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>D<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_f<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>F<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_g<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>G<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_k<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>K<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_m<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>M<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_n<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>N<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_p<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>P<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_r<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>R<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_s<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>S<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_t<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>T<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_u<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>U<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_v<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>V<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_x<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_y<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Y<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_w<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>W<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_z<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Z<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_1<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_2<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
    <span class="pl-v">TidyData</span> <span class="pl-k">=</span> <span class="pl-smi">pml.training</span>
    colnames(<span class="pl-smi">TidyData</span>) <span class="pl-k">=</span> <span class="pl-smi">temp</span></pre></div>

<p>Also, from the data structure we observe that there are missing values ("NA") in the data. We can check if the proportion is relevant using</p>

<div class="highlight highlight-source-r"><pre>    mean(is.na(<span class="pl-smi">TidyData</span>))</pre></div>

<div class="highlight highlight-source-r"><pre>    [<span class="pl-c1">1</span>] <span class="pl-c1">0.6131835</span></pre></div>

<p>Over 61% of the data is missing, which is a very significant proportion. So, we can set a threshold to remove variables that contain more than 95% of "NA", for example:</p>

<div class="highlight highlight-source-r"><pre>    <span class="pl-v">NewTidyData1</span> <span class="pl-k">=</span> <span class="pl-smi">TidyData</span>[, colSums(is.na(<span class="pl-smi">TidyData</span>))<span class="pl-k">/</span>nrow(<span class="pl-smi">TidyData</span>) <span class="pl-k">&lt;</span> <span class="pl-c1">0.95</span>]
    dim(<span class="pl-smi">NewTidyData1</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>   [<span class="pl-c1">1</span>] <span class="pl-c1">19622</span>    <span class="pl-c1">60</span></pre></div>

<div class="highlight highlight-source-r"><pre>   mean(is.na(<span class="pl-smi">NewTidyData1</span>))</pre></div>

<div class="highlight highlight-source-r"><pre>   [<span class="pl-c1">1</span>] <span class="pl-c1">0</span></pre></div>

<p>The <code>NewTidyData1</code> now does not contain any missing values. The first 20 rows of data structure of the <code>NewTidyData1</code>:</p>

<div class="highlight highlight-source-r"><pre> str(<span class="pl-smi">NewTidyData1</span>, <span class="pl-v">list.len</span><span class="pl-k">=</span><span class="pl-c1">20</span>)</pre></div>

<div class="highlight highlight-source-r"><pre><span class="pl-s"><span class="pl-pds">'</span>data.frame<span class="pl-pds">'</span></span><span class="pl-k">:</span>   <span class="pl-c1">19622</span> <span class="pl-smi">obs</span>. <span class="pl-smi">of</span>  <span class="pl-c1">60</span> <span class="pl-smi">variables</span><span class="pl-k">:</span>
 <span class="pl-k">$</span> <span class="pl-smi">X</span>                 <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">1</span> <span class="pl-c1">2</span> <span class="pl-c1">3</span> <span class="pl-c1">4</span> <span class="pl-c1">5</span> <span class="pl-c1">6</span> <span class="pl-c1">7</span> <span class="pl-c1">8</span> <span class="pl-c1">9</span> <span class="pl-c1">10</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">UserName</span>          <span class="pl-k">:</span> <span class="pl-smi">Factor</span> <span class="pl-smi">w</span><span class="pl-k">/</span> <span class="pl-c1">6</span> <span class="pl-smi">levels</span> <span class="pl-s"><span class="pl-pds">"</span>adelmo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>carlitos<span class="pl-pds">"</span></span>,..<span class="pl-k">:</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-c1">2</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">RawTimestampPart1</span> <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">1323084231</span> <span class="pl-c1">1323084231</span> <span class="pl-c1">1323084231</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-c1">1323084232</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">RawTimestampPart2</span> <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">788290</span> <span class="pl-c1">808298</span> <span class="pl-c1">820366</span> <span class="pl-c1">120339</span> <span class="pl-c1">196328</span> <span class="pl-c1">304277</span> <span class="pl-c1">368296</span> <span class="pl-c1">440390</span> <span class="pl-c1">484323</span> <span class="pl-c1">484434</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">CvtdTimestamp</span>     <span class="pl-k">:</span> <span class="pl-smi">Factor</span> <span class="pl-smi">w</span><span class="pl-k">/</span> <span class="pl-c1">20</span> <span class="pl-smi">levels</span> <span class="pl-s"><span class="pl-pds">"</span>02/12/2011 13:32<span class="pl-pds">"</span></span>,..<span class="pl-k">:</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-c1">9</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">NewWindow</span>         <span class="pl-k">:</span> <span class="pl-smi">Factor</span> <span class="pl-smi">w</span><span class="pl-k">/</span> <span class="pl-c1">2</span> <span class="pl-smi">levels</span> <span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">NumWindow</span>         <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">11</span> <span class="pl-c1">11</span> <span class="pl-c1">11</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-c1">12</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">RollBelt</span>          <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">1.41</span> <span class="pl-c1">1.41</span> <span class="pl-c1">1.42</span> <span class="pl-c1">1.48</span> <span class="pl-c1">1.48</span> <span class="pl-c1">1.45</span> <span class="pl-c1">1.42</span> <span class="pl-c1">1.42</span> <span class="pl-c1">1.43</span> <span class="pl-c1">1.45</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">PitchBelt</span>         <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">8.07</span> <span class="pl-c1">8.07</span> <span class="pl-c1">8.07</span> <span class="pl-c1">8.05</span> <span class="pl-c1">8.07</span> <span class="pl-c1">8.06</span> <span class="pl-c1">8.09</span> <span class="pl-c1">8.13</span> <span class="pl-c1">8.16</span> <span class="pl-c1">8.17</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">YawBelt</span>           <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">-</span><span class="pl-c1">94.4</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">TotalAccelBelt</span>    <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-c1">3</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">GyrosBeltX</span>        <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">0</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0.03</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">GyrosBeltY</span>        <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0.02</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">GyrosBeltZ</span>        <span class="pl-k">:</span> <span class="pl-smi">num</span>  <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.03</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-k">-</span><span class="pl-c1">0.02</span> <span class="pl-c1">0</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">AccelBeltX</span>        <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-k">-</span><span class="pl-c1">21</span> <span class="pl-k">-</span><span class="pl-c1">22</span> <span class="pl-k">-</span><span class="pl-c1">20</span> <span class="pl-k">-</span><span class="pl-c1">22</span> <span class="pl-k">-</span><span class="pl-c1">21</span> <span class="pl-k">-</span><span class="pl-c1">21</span> <span class="pl-k">-</span><span class="pl-c1">22</span> <span class="pl-k">-</span><span class="pl-c1">22</span> <span class="pl-k">-</span><span class="pl-c1">20</span> <span class="pl-k">-</span><span class="pl-c1">21</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">AccelBeltY</span>        <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">4</span> <span class="pl-c1">4</span> <span class="pl-c1">5</span> <span class="pl-c1">3</span> <span class="pl-c1">2</span> <span class="pl-c1">4</span> <span class="pl-c1">3</span> <span class="pl-c1">4</span> <span class="pl-c1">2</span> <span class="pl-c1">4</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">AccelBeltZ</span>        <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">22</span> <span class="pl-c1">22</span> <span class="pl-c1">23</span> <span class="pl-c1">21</span> <span class="pl-c1">24</span> <span class="pl-c1">21</span> <span class="pl-c1">21</span> <span class="pl-c1">21</span> <span class="pl-c1">24</span> <span class="pl-c1">22</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">MagnetBeltX</span>       <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-k">-</span><span class="pl-c1">3</span> <span class="pl-k">-</span><span class="pl-c1">7</span> <span class="pl-k">-</span><span class="pl-c1">2</span> <span class="pl-k">-</span><span class="pl-c1">6</span> <span class="pl-k">-</span><span class="pl-c1">6</span> <span class="pl-c1">0</span> <span class="pl-k">-</span><span class="pl-c1">4</span> <span class="pl-k">-</span><span class="pl-c1">2</span> <span class="pl-c1">1</span> <span class="pl-k">-</span><span class="pl-c1">3</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">MagnetBeltY</span>       <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-c1">599</span> <span class="pl-c1">608</span> <span class="pl-c1">600</span> <span class="pl-c1">604</span> <span class="pl-c1">600</span> <span class="pl-c1">603</span> <span class="pl-c1">599</span> <span class="pl-c1">603</span> <span class="pl-c1">602</span> <span class="pl-c1">609</span> <span class="pl-k">...</span>
 <span class="pl-k">$</span> <span class="pl-smi">MagnetBeltZ</span>       <span class="pl-k">:</span> <span class="pl-smi">int</span>  <span class="pl-k">-</span><span class="pl-c1">313</span> <span class="pl-k">-</span><span class="pl-c1">311</span> <span class="pl-k">-</span><span class="pl-c1">305</span> <span class="pl-k">-</span><span class="pl-c1">310</span> <span class="pl-k">-</span><span class="pl-c1">302</span> <span class="pl-k">-</span><span class="pl-c1">312</span> <span class="pl-k">-</span><span class="pl-c1">311</span> <span class="pl-k">-</span><span class="pl-c1">313</span> <span class="pl-k">-</span><span class="pl-c1">312</span> <span class="pl-k">-</span><span class="pl-c1">308</span> <span class="pl-k">...</span>
  [<span class="pl-smi">list</span> <span class="pl-smi">output</span> <span class="pl-smi">truncated</span>]    </pre></div>

<p>From the initial 160, there are a total of 60 variables. We can still reduce the number of variables <strong>assuming</strong> that the prediction is not time and individual dependent, that is, independent of the person and the time that the exercise was performed. Then, variables such as: <em>"UserName", "RawTimestampPart1", "RawTimestampPart2", "CvtdTimestamp", "NewWindow" and "NumWindow"</em> can be removed together with the index <em>"X"</em> variable:</p>

<div class="highlight highlight-source-r"><pre>    library(<span class="pl-smi">dplyr</span>)
    <span class="pl-v">SelectData</span> <span class="pl-k">=</span> select(<span class="pl-smi">NewTidyData1</span>,<span class="pl-k">-</span>c(<span class="pl-smi">X</span><span class="pl-k">:</span><span class="pl-smi">NumWindow</span>))
    dim(<span class="pl-smi">SelectData</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    [<span class="pl-c1">1</span>] <span class="pl-c1">19622</span>    <span class="pl-c1">53</span></pre></div>

<p>Therefore, the number of variables is reduced to 53.</p>

<h3>
<a id="model-building" class="anchor" href="#model-building" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Model Building</h3>

<p><strong>5.    Propose Machine learning models base on the exploratory data</strong></p>

<p>I used the <em>caret</em> package in this work. Caret stands for Classification And REgression Training. It is a great toolkit to build  classification and regression models. Caret also provides the means for: Data preparation, Data splitting, Training a Model, Model evaluation, and  Variable selection.</p>

<p><strong>5.1.    Data Preparation - Removing redundant variables by a correlation matrix</strong></p>

<p>The data variables may be correlated to each other, which it may lead to redundancy in the model (<em><em>assumption</em></em>). By using <code>findCorrelation</code> from the <em>caret</em> package, we can obtain the correlation matrix between the data variables. The function 
can plot the data set to visualise those correlations (See Figure 1).  The plot makes it less difficult to choose the threshold of the correlation coefficient in  order to remove redundant variables. I chose an absolute value for correlation coefficient of 0.90 as the threshold. Seven (7) other variables can be dropped.</p>

<div class="highlight highlight-source-r"><pre>    library(<span class="pl-smi">caret</span>)
    library(<span class="pl-smi">corrplot</span>)
    <span class="pl-smi">threshold</span>   <span class="pl-k">&lt;-</span>  <span class="pl-c1">0.90</span>
    <span class="pl-smi">corMatrix</span>   <span class="pl-k">&lt;-</span>  cor(<span class="pl-smi">SelectData</span>[,<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">52</span>])
    corrplot(<span class="pl-smi">corMatrix</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>square<span class="pl-pds">"</span></span>, <span class="pl-v">order</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>hclust<span class="pl-pds">"</span></span>) <span class="pl-c"># Plot the correlation matrix</span>

    <span class="pl-smi">highCor</span> <span class="pl-k">&lt;-</span>  findCorrelation(<span class="pl-smi">corMatrix</span>, <span class="pl-smi">threshold</span>) <span class="pl-c">#sub set those that thas correlation &gt;, = 0.9, or &lt; -0.9</span>
    <span class="pl-smi">highCorRm</span>   <span class="pl-k">&lt;-</span>  row.names(<span class="pl-smi">corMatrix</span>)[<span class="pl-smi">highCor</span>]
    <span class="pl-smi">highCorRm</span></pre></div>

<div class="highlight highlight-source-r"><pre>    [<span class="pl-c1">1</span>] <span class="pl-s"><span class="pl-pds">"</span>AccelBeltZ<span class="pl-pds">"</span></span>    <span class="pl-s"><span class="pl-pds">"</span>RollBelt<span class="pl-pds">"</span></span>       <span class="pl-s"><span class="pl-pds">"</span>AccelBeltY<span class="pl-pds">"</span></span>     <span class="pl-s"><span class="pl-pds">"</span>AccelBeltX<span class="pl-pds">"</span></span>     
        <span class="pl-s"><span class="pl-pds">"</span>GyrosDumbbellX<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>GyrosDumbbellZ<span class="pl-pds">"</span></span>  <span class="pl-s"><span class="pl-pds">"</span>GyrosArmX<span class="pl-pds">"</span></span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">SelectData2</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">SelectData</span>[, <span class="pl-k">-</span><span class="pl-smi">highCor</span>]
    dim(<span class="pl-smi">SelectData2</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    [<span class="pl-c1">1</span>] <span class="pl-c1">19622</span>    <span class="pl-c1">46</span></pre></div>

<p align="center">
  <img src="https://raw.githubusercontent.com/anonymous-1618/ML/master/Fig1.png">
  <b>Figure 1 - </b>Variables Correlation Map<br>
  </p>

<p><strong>5.2.  Data splitting</strong></p>

<p>The <em>caret</em> function <code>createDataPartition</code> is used to randomly split the data set. I set the standard proportion of 60% of the data to be used for model training and 40% used for testing model performance.</p>

<div class="highlight highlight-source-r"><pre>    library(<span class="pl-s"><span class="pl-pds">"</span>caret<span class="pl-pds">"</span></span>)
    library(<span class="pl-s"><span class="pl-pds">"</span>e1071<span class="pl-pds">"</span></span>)
    set.seed(<span class="pl-c1">1023</span>)
    <span class="pl-smi">inTrain</span> <span class="pl-k">&lt;-</span> createDataPartition(<span class="pl-smi">SelectData2</span><span class="pl-k">$</span><span class="pl-smi">Class</span>, <span class="pl-v">p</span> <span class="pl-k">=</span> <span class="pl-c1">0.6</span>, <span class="pl-v">list</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>)
    <span class="pl-smi">trainData</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">SelectData2</span>[<span class="pl-smi">inTrain</span>,]
    <span class="pl-smi">testData</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">SelectData2</span>[<span class="pl-k">-</span><span class="pl-smi">inTrain</span>,]</pre></div>

<p><strong>5.3.  Training a Model/Tuning Parameters/Variable Selection</strong></p>

<p>As the main question of this assignment is about classification, I choose Random Forest ("rf") to build the model. Tuning the model means to choose a set of parameters to be evaluated. Once the model and tuning parameters are chosen, the type of resampling needs to be opted for. Caret Package has tools to perform, k-fold cross-validation (once or repeated), leave-one-out cross-validation and bootstrap (<strong>default</strong>) resampling. Once the resampling was processed, the caret <code>train</code> function automatically chooses the best tuning parameters associated to the model.</p>

<div class="highlight highlight-source-r"><pre>    set.seed(<span class="pl-c1">3023</span>)
    <span class="pl-v">modelFit2</span> <span class="pl-k">=</span> train(<span class="pl-smi">Classe</span> <span class="pl-k">~</span>., <span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">trainData</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>, <span class="pl-v">prox</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)
    <span class="pl-smi">modelFit2</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-c1">11776</span> <span class="pl-smi">samples</span>
    <span class="pl-c1">45</span> <span class="pl-smi">predictor</span>
    <span class="pl-c1">5</span> <span class="pl-smi">classes</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>E<span class="pl-pds">'</span></span> 

    <span class="pl-smi">No</span> <span class="pl-smi">pre</span><span class="pl-k">-</span><span class="pl-smi">processing</span>
    <span class="pl-smi">Resampling</span><span class="pl-k">:</span> Bootstrapped (<span class="pl-c1">25</span> <span class="pl-smi">reps</span>) 
    <span class="pl-smi">Summary</span> <span class="pl-smi">of</span> <span class="pl-smi">sample</span> <span class="pl-smi">sizes</span><span class="pl-k">:</span> <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-k">...</span> 
    <span class="pl-smi">Resampling</span> <span class="pl-smi">results</span> <span class="pl-smi">across</span> <span class="pl-smi">tuning</span> <span class="pl-smi">parameters</span><span class="pl-k">:</span>

    <span class="pl-smi">mtry</span>  <span class="pl-smi">Accuracy</span>   <span class="pl-smi">Kappa</span>    
    <span class="pl-c1">2</span>     <span class="pl-c1">0.9856378</span>  <span class="pl-c1">0.9818241</span>
    <span class="pl-c1">23</span>    <span class="pl-c1">0.9874277</span>  <span class="pl-c1">0.9840903</span>
    <span class="pl-c1">45</span>    <span class="pl-c1">0.9752460</span>  <span class="pl-c1">0.9686771</span>

    <span class="pl-smi">Accuracy</span> <span class="pl-smi">was</span> <span class="pl-smi">used</span> <span class="pl-smi">to</span> <span class="pl-smi">select</span> <span class="pl-smi">the</span> <span class="pl-smi">optimal</span> <span class="pl-smi">model</span> <span class="pl-smi">using</span>  <span class="pl-smi">the</span> <span class="pl-smi">largest</span> <span class="pl-smi">value</span>.
    <span class="pl-smi">The</span> <span class="pl-smi">final</span> <span class="pl-smi">value</span> <span class="pl-smi">used</span> <span class="pl-k">for</span> <span class="pl-smi">the</span> <span class="pl-smi">model</span> <span class="pl-smi">was</span> <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-c1">23</span>. </pre></div>

<p>Accuracy is the default metric selected to be optimized in <code>train()</code> for categorical variables, in this case, "Classe". The proposed model shows that 23 predictors were needed to get the best accuracy on the training set. In order words, <code>caret</code> has optimised the model and concluded that selecting 23 most important predictors gives the best accuracy. The "out-of-bag" (OOB) error rate of the final model can be obtained by:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">modelFit2</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Call</span><span class="pl-k">:</span>
    randomForest(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>, <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-smi">param</span><span class="pl-k">$</span><span class="pl-smi">mtry</span>, <span class="pl-v">proximity</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>) 
               <span class="pl-smi">Type</span> <span class="pl-smi">of</span> <span class="pl-smi">random</span> <span class="pl-smi">forest</span><span class="pl-k">:</span> <span class="pl-smi">classification</span>
                     <span class="pl-smi">Number</span> <span class="pl-smi">of</span> <span class="pl-smi">trees</span><span class="pl-k">:</span> <span class="pl-c1">500</span>
    <span class="pl-smi">No</span>. <span class="pl-smi">of</span> <span class="pl-smi">variables</span> <span class="pl-smi">tried</span> <span class="pl-smi">at</span> <span class="pl-smi">each</span> <span class="pl-smi">split</span><span class="pl-k">:</span> <span class="pl-c1">23</span>

            <span class="pl-smi">OOB</span> <span class="pl-smi">estimate</span> <span class="pl-smi">of</span>  <span class="pl-smi">error</span> <span class="pl-smi">rate</span><span class="pl-k">:</span> <span class="pl-c1">0.91</span>%
    <span class="pl-smi">Confusion</span> <span class="pl-smi">matrix</span><span class="pl-k">:</span>
         <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span>    <span class="pl-smi">class.error</span>
    <span class="pl-smi">A</span> <span class="pl-c1">3338</span>    <span class="pl-c1">6</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span>    <span class="pl-c1">2</span>  <span class="pl-c1">0.002986858</span>
    <span class="pl-smi">B</span>   <span class="pl-c1">22</span> <span class="pl-c1">2243</span>   <span class="pl-c1">14</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>  <span class="pl-c1">0.015796402</span>
    <span class="pl-smi">C</span>    <span class="pl-c1">0</span>   <span class="pl-c1">14</span> <span class="pl-c1">2031</span>    <span class="pl-c1">9</span>    <span class="pl-c1">0</span>  <span class="pl-c1">0.011197663</span>
    <span class="pl-smi">D</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>   <span class="pl-c1">25</span> <span class="pl-c1">1903</span>    <span class="pl-c1">1</span>  <span class="pl-c1">0.013989637</span>
    <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">1</span>    <span class="pl-c1">2</span>    <span class="pl-c1">8</span> <span class="pl-c1">2154</span>  <span class="pl-c1">0.005080831</span></pre></div>

<p>However the better error estimates is obtained by using the testing set (as I show in the Evaluation section). We can also calculate the variable importance in the model by using the caret package <code>varImp</code> function:</p>

<div class="highlight highlight-source-r"><pre>    varImp(<span class="pl-smi">modelFit2</span>, <span class="pl-v">scale</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)[[<span class="pl-c1">1</span>]]</pre></div>

<div class="highlight highlight-source-r"><pre>                        <span class="pl-smi">Overall</span>
    <span class="pl-smi">PitchBelt</span>           <span class="pl-c1">71.88966676</span>
    <span class="pl-smi">YawBelt</span>            <span class="pl-c1">100.00000000</span>
    <span class="pl-smi">TotalAccelBelt</span>      <span class="pl-c1">15.13943598</span>
    <span class="pl-smi">GyrosBeltX</span>           <span class="pl-c1">4.10645743</span>
    <span class="pl-smi">GyrosBeltY</span>           <span class="pl-c1">4.29909507</span>
    <span class="pl-smi">GyrosBeltZ</span>          <span class="pl-c1">28.77409715</span>
    <span class="pl-smi">MagnetBeltX</span>         <span class="pl-c1">19.06090724</span>
    <span class="pl-smi">MagnetBeltY</span>         <span class="pl-c1">46.42143718</span>
    <span class="pl-smi">MagnetBeltZ</span>         <span class="pl-c1">29.86221750</span>
    <span class="pl-smi">RollArm</span>             <span class="pl-c1">13.36456325</span>
    <span class="pl-smi">PitchArm</span>             <span class="pl-c1">5.30347638</span>
    <span class="pl-smi">YawArm</span>              <span class="pl-c1">14.18155500</span>
    <span class="pl-smi">TotalAccelArm</span>        <span class="pl-c1">2.06975968</span>
    <span class="pl-smi">GyrosArmY</span>            <span class="pl-c1">7.26378887</span>
    <span class="pl-smi">GyrosArmZ</span>            <span class="pl-c1">0.00000000</span>
    <span class="pl-smi">AccelArmX</span>            <span class="pl-c1">6.52209427</span>
    <span class="pl-smi">AccelArmY</span>            <span class="pl-c1">6.87352864</span>
    <span class="pl-smi">AccelArmZ</span>            <span class="pl-c1">2.89186020</span>
    <span class="pl-smi">MagnetArmX</span>           <span class="pl-c1">8.30696563</span>
    <span class="pl-smi">MagnetArmY</span>           <span class="pl-c1">9.05507339</span>
    <span class="pl-smi">MagnetArmZ</span>           <span class="pl-c1">7.15700321</span>
    <span class="pl-smi">RollDumbbell</span>        <span class="pl-c1">27.13032649</span>
    <span class="pl-smi">PitchDumbbell</span>        <span class="pl-c1">6.15535378</span>
    <span class="pl-smi">YawDumbbell</span>         <span class="pl-c1">11.93242077</span>
    <span class="pl-smi">TotalAccelDumbbell</span>  <span class="pl-c1">18.91942501</span>
    <span class="pl-smi">GyrosDumbbellY</span>      <span class="pl-c1">10.63841552</span>
    <span class="pl-smi">AccelDumbbellX</span>       <span class="pl-c1">7.25232796</span>
    <span class="pl-smi">AccelDumbbellY</span>      <span class="pl-c1">27.33024178</span>
    <span class="pl-smi">AccelDumbbellZ</span>      <span class="pl-c1">19.02170061</span>
    <span class="pl-smi">MagnetDumbbellX</span>     <span class="pl-c1">28.23072724</span>
    <span class="pl-smi">MagnetDumbbellY</span>     <span class="pl-c1">51.95465439</span>
    <span class="pl-smi">MagnetDumbbellZ</span>     <span class="pl-c1">63.81343801</span>
    <span class="pl-smi">RollForearm</span>         <span class="pl-c1">50.97284067</span>
    <span class="pl-smi">PitchForearm</span>        <span class="pl-c1">86.88962083</span>
    <span class="pl-smi">YawForearm</span>           <span class="pl-c1">7.33542669</span>
    <span class="pl-smi">TotalAccelForearm</span>    <span class="pl-c1">2.41288158</span>
    <span class="pl-smi">GyrosForearmX</span>        <span class="pl-c1">0.02460776</span>
    <span class="pl-smi">GyrosForearmY</span>        <span class="pl-c1">3.64303343</span>
    <span class="pl-smi">GyrosForearmZ</span>        <span class="pl-c1">0.95471639</span>
    <span class="pl-smi">AccelForearmX</span>       <span class="pl-c1">21.54543983</span>
    <span class="pl-smi">AccelForearmY</span>        <span class="pl-c1">3.55059378</span>
    <span class="pl-smi">AccelForearmZ</span>       <span class="pl-c1">17.05528477</span>
    <span class="pl-smi">MagnetForearmX</span>       <span class="pl-c1">9.02319380</span>
    <span class="pl-smi">MagnetForearmY</span>       <span class="pl-c1">7.14137478</span>
    <span class="pl-smi">MagnetForearmZ</span>      <span class="pl-c1">15.57428210</span></pre></div>

<p>We can also get the plot of the variable importance sorted in descending order by <code>plot(varImp(modelFit2, scale=TRUE))</code>. See Figure 2.</p>

<p align="center">
  <img src="https://raw.githubusercontent.com/anonymous-1618/ML/master/Fig2.png">
  <b>Figure 2 - </b>Variable Importance<br>
  </p>

<p><strong>5.4.    Model Evaluation</strong>
The evalution of the training fit model can be made by using the caret <code>predict()</code>function on the testing set:</p>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">testPred</span> <span class="pl-k">&lt;-</span> predict(<span class="pl-smi">modelFit2</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">testData</span>)</pre></div>

<p>Now we can compare the prediction result of the testing set with the actual values by using the <code>confusionMatrix()</code> function:</p>

<div class="highlight highlight-source-r"><pre>    confusionMatrix(<span class="pl-smi">testData</span><span class="pl-k">$</span><span class="pl-smi">Classe</span>,<span class="pl-smi">testPred</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Confusion</span> <span class="pl-smi">Matrix</span> <span class="pl-smi">and</span> <span class="pl-smi">Statistics</span>

              <span class="pl-smi">Reference</span>
    <span class="pl-smi">Prediction</span>     <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span>
         <span class="pl-smi">A</span>      <span class="pl-c1">2232</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
         <span class="pl-smi">B</span>         <span class="pl-c1">5</span> <span class="pl-c1">1505</span>    <span class="pl-c1">8</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
         <span class="pl-smi">C</span>         <span class="pl-c1">0</span>    <span class="pl-c1">5</span> <span class="pl-c1">1361</span>    <span class="pl-c1">2</span>    <span class="pl-c1">0</span>
         <span class="pl-smi">D</span>         <span class="pl-c1">0</span>    <span class="pl-c1">1</span>   <span class="pl-c1">22</span> <span class="pl-c1">1261</span>    <span class="pl-c1">2</span>
         <span class="pl-smi">E</span>         <span class="pl-c1">0</span>    <span class="pl-c1">1</span>    <span class="pl-c1">3</span>    <span class="pl-c1">4</span> <span class="pl-c1">1434</span>

    <span class="pl-smi">Overall</span> <span class="pl-smi">Statistics</span>

               <span class="pl-smi">Accuracy</span> <span class="pl-k">:</span> <span class="pl-c1">0.9932</span>          
                 <span class="pl-c1">95</span>% <span class="pl-smi">CI</span> <span class="pl-k">:</span> (<span class="pl-c1">0.9912</span>, <span class="pl-c1">0.9949</span>)
    <span class="pl-smi">No</span> <span class="pl-smi">Information</span> <span class="pl-smi">Rate</span> <span class="pl-k">:</span> <span class="pl-c1">0.2851</span>          
    <span class="pl-smi">P</span><span class="pl-k">-</span><span class="pl-smi">Value</span> [<span class="pl-smi">Acc</span> <span class="pl-k">&gt;</span> <span class="pl-smi">NIR</span>] <span class="pl-k">:</span> <span class="pl-k">&lt;</span> <span class="pl-c1">2.2e-16</span>       

                  <span class="pl-smi">Kappa</span> <span class="pl-k">:</span> <span class="pl-c1">0.9915</span>          
    <span class="pl-smi">Mcnemar</span><span class="pl-s"><span class="pl-pds">'</span>s Test P-Value : NA              </span>
<span class="pl-s"></span>
<span class="pl-s">    Statistics by Class:</span>
<span class="pl-s"></span>
<span class="pl-s">                         Class: A Class: B Class: C Class: D Class: E</span>
<span class="pl-s">    Sensitivity            0.9978   0.9954   0.9763   0.9953   0.9986</span>
<span class="pl-s">    Specificity            1.0000   0.9979   0.9989   0.9962   0.9988</span>
<span class="pl-s">    Pos Pred Value         1.0000   0.9914   0.9949   0.9806   0.9945</span>
<span class="pl-s">    Neg Pred Value         0.9991   0.9989   0.9949   0.9991   0.9997</span>
<span class="pl-s">    Prevalence             0.2851   0.1927   0.1777   0.1615   0.1830</span>
<span class="pl-s">    Detection Rate         0.2845   0.1918   0.1735   0.1607   0.1828</span>
<span class="pl-s">    Detection Prevalence   0.2845   0.1935   0.1744   0.1639   0.1838</span>
<span class="pl-s">    Balanced Accuracy      0.9989   0.9967   0.9876   0.9957   0.9987</span></pre></div>

<p>Therefore the accuray estimated for the model fit is 0.9932 which means that the estimation error is ca. 0.68%.</p>

<h3>
<a id="model-parameters-effect" class="anchor" href="#model-parameters-effect" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Model Parameters Effect:</h3>

<ol>
<li> Selecting variables by Variable importance ranking:</li>
</ol>

<p>I tried to improve the model by changing the number of predictors. Based on the previous results, I reduced more of the number of variables by creating a cutoff point for the best variables by their importance:</p>

<div class="highlight highlight-source-r"><pre>    library(<span class="pl-smi">dplyr</span>)
    <span class="pl-v">temp</span> <span class="pl-k">=</span>varImp(<span class="pl-smi">modelFit2</span>, <span class="pl-v">scale</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)
    <span class="pl-v">temp.df</span> <span class="pl-k">=</span>as.data.frame(<span class="pl-smi">temp</span>[[<span class="pl-c1">1</span>]])
    <span class="pl-v">temp.df</span> <span class="pl-k">=</span> cbind(<span class="pl-v">Variables</span> <span class="pl-k">=</span> rownames(<span class="pl-smi">temp.df</span>),<span class="pl-smi">temp.df</span>)
    <span class="pl-v">Impvar.names</span> <span class="pl-k">=</span> as.vector(filter(<span class="pl-smi">temp.df</span>, <span class="pl-smi">Overall</span> <span class="pl-k">&gt;</span> <span class="pl-c1">10</span>)[,<span class="pl-c1">1</span>])     <span class="pl-c">#filtering to variables with importance &gt; 10%#</span>
    <span class="pl-smi">Impvar.names</span></pre></div>

<div class="highlight highlight-source-r"><pre>    [<span class="pl-c1">1</span>] <span class="pl-s"><span class="pl-pds">"</span>PitchBelt<span class="pl-pds">"</span></span>          <span class="pl-s"><span class="pl-pds">"</span>YawBelt<span class="pl-pds">"</span></span>            <span class="pl-s"><span class="pl-pds">"</span>TotalAccelBelt<span class="pl-pds">"</span></span>     <span class="pl-s"><span class="pl-pds">"</span>GyrosBeltZ<span class="pl-pds">"</span></span>        
    [<span class="pl-c1">5</span>] <span class="pl-s"><span class="pl-pds">"</span>MagnetBeltX<span class="pl-pds">"</span></span>        <span class="pl-s"><span class="pl-pds">"</span>MagnetBeltY<span class="pl-pds">"</span></span>        <span class="pl-s"><span class="pl-pds">"</span>MagnetBeltZ<span class="pl-pds">"</span></span>        <span class="pl-s"><span class="pl-pds">"</span>RollArm<span class="pl-pds">"</span></span>           
    [<span class="pl-c1">9</span>] <span class="pl-s"><span class="pl-pds">"</span>YawArm<span class="pl-pds">"</span></span>             <span class="pl-s"><span class="pl-pds">"</span>RollDumbbell<span class="pl-pds">"</span></span>       <span class="pl-s"><span class="pl-pds">"</span>YawDumbbell<span class="pl-pds">"</span></span>        <span class="pl-s"><span class="pl-pds">"</span>TotalAccelDumbbell<span class="pl-pds">"</span></span>
    [<span class="pl-c1">13</span>] <span class="pl-s"><span class="pl-pds">"</span>GyrosDumbbellY<span class="pl-pds">"</span></span>     <span class="pl-s"><span class="pl-pds">"</span>AccelDumbbellY<span class="pl-pds">"</span></span>     <span class="pl-s"><span class="pl-pds">"</span>AccelDumbbellZ<span class="pl-pds">"</span></span>     <span class="pl-s"><span class="pl-pds">"</span>MagnetDumbbellX<span class="pl-pds">"</span></span>   
    [<span class="pl-c1">17</span>] <span class="pl-s"><span class="pl-pds">"</span>MagnetDumbbellY<span class="pl-pds">"</span></span>    <span class="pl-s"><span class="pl-pds">"</span>MagnetDumbbellZ<span class="pl-pds">"</span></span>    <span class="pl-s"><span class="pl-pds">"</span>RollForearm<span class="pl-pds">"</span></span>        <span class="pl-s"><span class="pl-pds">"</span>PitchForearm<span class="pl-pds">"</span></span>      
    [<span class="pl-c1">21</span>] <span class="pl-s"><span class="pl-pds">"</span>AccelForearmX<span class="pl-pds">"</span></span>      <span class="pl-s"><span class="pl-pds">"</span>AccelForearmZ<span class="pl-pds">"</span></span>      <span class="pl-s"><span class="pl-pds">"</span>MagnetForearmZ<span class="pl-pds">"</span></span>  </pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-v">selectVar</span> <span class="pl-k">=</span> c(<span class="pl-smi">Impvar.names</span>,<span class="pl-s"><span class="pl-pds">"</span>Classe<span class="pl-pds">"</span></span>)
    <span class="pl-v">trainDataImp</span> <span class="pl-k">=</span> <span class="pl-smi">trainData</span>[,<span class="pl-smi">Impvar.names</span>]
    <span class="pl-v">modelFit2a</span> <span class="pl-k">=</span> train(<span class="pl-smi">Classe</span> <span class="pl-k">~</span>., <span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">trainDataImp</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>, <span class="pl-v">prox</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-v">modelFit2a</span> <span class="pl-k">=</span> train(<span class="pl-smi">Classe</span> <span class="pl-k">~</span>., <span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">trainDataImp</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>, <span class="pl-v">prox</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)
    <span class="pl-smi">modelFit2a</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Random</span> <span class="pl-smi">Forest</span> 

    <span class="pl-c1">11776</span> <span class="pl-smi">samples</span>
       <span class="pl-c1">23</span> <span class="pl-smi">predictor</span>
        <span class="pl-c1">5</span> <span class="pl-smi">classes</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>E<span class="pl-pds">'</span></span> 

    <span class="pl-smi">No</span> <span class="pl-smi">pre</span><span class="pl-k">-</span><span class="pl-smi">processing</span>
    <span class="pl-smi">Resampling</span><span class="pl-k">:</span> Bootstrapped (<span class="pl-c1">25</span> <span class="pl-smi">reps</span>) 
    <span class="pl-smi">Summary</span> <span class="pl-smi">of</span> <span class="pl-smi">sample</span> <span class="pl-smi">sizes</span><span class="pl-k">:</span> <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-c1">11776</span>, <span class="pl-k">...</span> 
    <span class="pl-smi">Resampling</span> <span class="pl-smi">results</span> <span class="pl-smi">across</span> <span class="pl-smi">tuning</span> <span class="pl-smi">parameters</span><span class="pl-k">:</span>

      <span class="pl-smi">mtry</span>  <span class="pl-smi">Accuracy</span>   <span class="pl-smi">Kappa</span>    
       <span class="pl-c1">2</span>    <span class="pl-c1">0.9815209</span>  <span class="pl-c1">0.9765947</span>
      <span class="pl-c1">12</span>    <span class="pl-c1">0.9816863</span>  <span class="pl-c1">0.9768206</span>
      <span class="pl-c1">23</span>    <span class="pl-c1">0.9697268</span>  <span class="pl-c1">0.9616665</span>

    <span class="pl-smi">Accuracy</span> <span class="pl-smi">was</span> <span class="pl-smi">used</span> <span class="pl-smi">to</span> <span class="pl-smi">select</span> <span class="pl-smi">the</span> <span class="pl-smi">optimal</span> <span class="pl-smi">model</span> <span class="pl-smi">using</span>  <span class="pl-smi">the</span> <span class="pl-smi">largest</span> <span class="pl-smi">value</span>.
    <span class="pl-smi">The</span> <span class="pl-smi">final</span> <span class="pl-smi">value</span> <span class="pl-smi">used</span> <span class="pl-k">for</span> <span class="pl-smi">the</span> <span class="pl-smi">model</span> <span class="pl-smi">was</span> <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-c1">12</span>.</pre></div>

<div class="highlight highlight-source-r"><pre>   <span class="pl-smi">modelFit2a</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Call</span><span class="pl-k">:</span>
    randomForest(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>, <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-smi">param</span><span class="pl-k">$</span><span class="pl-smi">mtry</span>, <span class="pl-v">proximity</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>) 
                   <span class="pl-smi">Type</span> <span class="pl-smi">of</span> <span class="pl-smi">random</span> <span class="pl-smi">forest</span><span class="pl-k">:</span> <span class="pl-smi">classification</span>
                         <span class="pl-smi">Number</span> <span class="pl-smi">of</span> <span class="pl-smi">trees</span><span class="pl-k">:</span> <span class="pl-c1">500</span>
    <span class="pl-smi">No</span>. <span class="pl-smi">of</span> <span class="pl-smi">variables</span> <span class="pl-smi">tried</span> <span class="pl-smi">at</span> <span class="pl-smi">each</span> <span class="pl-smi">split</span><span class="pl-k">:</span> <span class="pl-c1">12</span>

            <span class="pl-smi">OOB</span> <span class="pl-smi">estimate</span> <span class="pl-smi">of</span>  <span class="pl-smi">error</span> <span class="pl-smi">rate</span><span class="pl-k">:</span> <span class="pl-c1">1.07</span>%
    <span class="pl-smi">Confusion</span> <span class="pl-smi">matrix</span><span class="pl-k">:</span>
         <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span> <span class="pl-smi">class.error</span>
    <span class="pl-smi">A</span> <span class="pl-c1">3337</span>    <span class="pl-c1">7</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.003285544</span>
    <span class="pl-smi">B</span>   <span class="pl-c1">22</span> <span class="pl-c1">2230</span>   <span class="pl-c1">24</span>    <span class="pl-c1">1</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.021500658</span>
    <span class="pl-smi">C</span>    <span class="pl-c1">0</span>   <span class="pl-c1">15</span> <span class="pl-c1">2021</span>   <span class="pl-c1">18</span>    <span class="pl-c1">0</span> <span class="pl-c1">0.016066212</span>
    <span class="pl-smi">D</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span>   <span class="pl-c1">19</span> <span class="pl-c1">1907</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.011917098</span>
    <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">1</span>    <span class="pl-c1">3</span>    <span class="pl-c1">6</span> <span class="pl-c1">2155</span> <span class="pl-c1">0.004618938</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">testPred</span> <span class="pl-k">&lt;-</span> predict(<span class="pl-smi">modelFit2a</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">testData</span>)
    confusionMatrix(<span class="pl-smi">testData</span><span class="pl-k">$</span><span class="pl-smi">Classe</span>,<span class="pl-smi">testPred</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Confusion</span> <span class="pl-smi">Matrix</span> <span class="pl-smi">and</span> <span class="pl-smi">Statistics</span>

              <span class="pl-smi">Reference</span>
    <span class="pl-smi">Prediction</span>    <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span>
             <span class="pl-smi">A</span> <span class="pl-c1">2231</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">B</span>    <span class="pl-c1">5</span> <span class="pl-c1">1499</span>   <span class="pl-c1">13</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">C</span>    <span class="pl-c1">0</span>    <span class="pl-c1">4</span> <span class="pl-c1">1355</span>    <span class="pl-c1">9</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">D</span>    <span class="pl-c1">0</span>    <span class="pl-c1">1</span>   <span class="pl-c1">21</span> <span class="pl-c1">1260</span>    <span class="pl-c1">4</span>
             <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">3</span>    <span class="pl-c1">5</span> <span class="pl-c1">1434</span>

    <span class="pl-smi">Overall</span> <span class="pl-smi">Statistics</span>

                   <span class="pl-smi">Accuracy</span> <span class="pl-k">:</span> <span class="pl-c1">0.9915</span>          
                     <span class="pl-c1">95</span>% <span class="pl-smi">CI</span> <span class="pl-k">:</span> (<span class="pl-c1">0.9892</span>, <span class="pl-c1">0.9934</span>)
        <span class="pl-smi">No</span> <span class="pl-smi">Information</span> <span class="pl-smi">Rate</span> <span class="pl-k">:</span> <span class="pl-c1">0.285</span>           
        <span class="pl-smi">P</span><span class="pl-k">-</span><span class="pl-smi">Value</span> [<span class="pl-smi">Acc</span> <span class="pl-k">&gt;</span> <span class="pl-smi">NIR</span>] <span class="pl-k">:</span> <span class="pl-k">&lt;</span> <span class="pl-c1">2.2e-16</span>       

                      <span class="pl-smi">Kappa</span> <span class="pl-k">:</span> <span class="pl-c1">0.9892</span>          
        <span class="pl-smi">Mcnemar</span><span class="pl-s"><span class="pl-pds">'</span>s Test P-Value : NA              </span>
<span class="pl-s"></span>
<span class="pl-s">        Statistics by Class:</span>
<span class="pl-s"></span>
<span class="pl-s">                             Class: A Class: B Class: C Class: D Class: E</span>
<span class="pl-s">        Sensitivity            0.9978   0.9960   0.9734   0.9882   0.9972</span>
<span class="pl-s">        Specificity            0.9998   0.9970   0.9980   0.9960   0.9988</span>
<span class="pl-s">        Pos Pred Value         0.9996   0.9875   0.9905   0.9798   0.9945</span>
<span class="pl-s">        Neg Pred Value         0.9991   0.9991   0.9943   0.9977   0.9994</span>
<span class="pl-s">        Prevalence             0.2850   0.1918   0.1774   0.1625   0.1833</span>
<span class="pl-s">        Detection Rate         0.2843   0.1911   0.1727   0.1606   0.1828</span>
<span class="pl-s">        Detection Prevalence   0.2845   0.1935   0.1744   0.1639   0.1838</span>
<span class="pl-s">        Balanced Accuracy      0.9988   0.9965   0.9857   0.9921   0.9980</span></pre></div>

<p>In this trial, the number of predictors selected in the final model was again decreased to <strong>12 predictors</strong>. This makes the model less complex. However, the OOB error rate (1.07%) and the test accuracy (0.9915) are slightly poorer than the original model. Also, the calculation time increased by half hour (ca. 5.5 h). </p>

<ol>
<li> Cross-Validation type:</li>
</ol>

<p>I also worked with 10-fold cross-validation (k=10). This resampling in general was much faster than bootstrap, that is, roughly ten-fold faster. As we can see in the results shown below, the accuracy is very similar to the "rf" but the OOB error is smaller that the original model. The following calculation uses the data with an importance variable cutoff of 10%.</p>

<div class="highlight highlight-source-r"><pre>    set.seed(<span class="pl-c1">1825</span>)
    <span class="pl-smi">fitControl</span> <span class="pl-k">&lt;-</span> trainControl( <span class="pl-v">method</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>cv<span class="pl-pds">"</span></span>, <span class="pl-v">number</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>)
    <span class="pl-smi">modelFit2c</span> <span class="pl-k">&lt;-</span> train(<span class="pl-smi">Classe</span> <span class="pl-k">~</span> ., <span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">trainDataImp</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>, <span class="pl-v">trControl</span> <span class="pl-k">=</span> <span class="pl-smi">fitControl</span>)
    <span class="pl-smi">modelFit2c</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Random</span> <span class="pl-smi">Forest</span> 

    <span class="pl-c1">11776</span> <span class="pl-smi">samples</span>
       <span class="pl-c1">23</span> <span class="pl-smi">predictor</span>
        <span class="pl-c1">5</span> <span class="pl-smi">classes</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>E<span class="pl-pds">'</span></span> 

    <span class="pl-smi">No</span> <span class="pl-smi">pre</span><span class="pl-k">-</span><span class="pl-smi">processing</span>
    <span class="pl-smi">Resampling</span><span class="pl-k">:</span> <span class="pl-smi">Cross</span><span class="pl-k">-</span>Validated (<span class="pl-c1">10</span> <span class="pl-smi">fold</span>) 
    <span class="pl-smi">Summary</span> <span class="pl-smi">of</span> <span class="pl-smi">sample</span> <span class="pl-smi">sizes</span><span class="pl-k">:</span> <span class="pl-c1">10598</span>, <span class="pl-c1">10598</span>, <span class="pl-c1">10599</span>, <span class="pl-c1">10599</span>, <span class="pl-c1">10598</span>, <span class="pl-c1">10598</span>, <span class="pl-k">...</span> 
    <span class="pl-smi">Resampling</span> <span class="pl-smi">results</span> <span class="pl-smi">across</span> <span class="pl-smi">tuning</span> <span class="pl-smi">parameters</span><span class="pl-k">:</span>

      <span class="pl-smi">mtry</span>  <span class="pl-smi">Accuracy</span>   <span class="pl-smi">Kappa</span>    
       <span class="pl-c1">2</span>    <span class="pl-c1">0.9862432</span>  <span class="pl-c1">0.9825951</span>
      <span class="pl-c1">12</span>    <span class="pl-c1">0.9872615</span>  <span class="pl-c1">0.9838864</span>
      <span class="pl-c1">23</span>    <span class="pl-c1">0.9783446</span>  <span class="pl-c1">0.9726068</span>

    <span class="pl-smi">Accuracy</span> <span class="pl-smi">was</span> <span class="pl-smi">used</span> <span class="pl-smi">to</span> <span class="pl-smi">select</span> <span class="pl-smi">the</span> <span class="pl-smi">optimal</span> <span class="pl-smi">model</span> <span class="pl-smi">using</span>  <span class="pl-smi">the</span> <span class="pl-smi">largest</span> <span class="pl-smi">value</span>.
    <span class="pl-smi">The</span> <span class="pl-smi">final</span> <span class="pl-smi">value</span> <span class="pl-smi">used</span> <span class="pl-k">for</span> <span class="pl-smi">the</span> <span class="pl-smi">model</span> <span class="pl-smi">was</span> <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-c1">12</span>. </pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">modelFit2c</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span>

  <span class="pl-smi">Call</span><span class="pl-k">:</span>
   randomForest(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>, <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-smi">param</span><span class="pl-k">$</span><span class="pl-smi">mtry</span>) 
                 <span class="pl-smi">Type</span> <span class="pl-smi">of</span> <span class="pl-smi">random</span> <span class="pl-smi">forest</span><span class="pl-k">:</span> <span class="pl-smi">classification</span>
                       <span class="pl-smi">Number</span> <span class="pl-smi">of</span> <span class="pl-smi">trees</span><span class="pl-k">:</span> <span class="pl-c1">500</span>
  <span class="pl-smi">No</span>. <span class="pl-smi">of</span> <span class="pl-smi">variables</span> <span class="pl-smi">tried</span> <span class="pl-smi">at</span> <span class="pl-smi">each</span> <span class="pl-smi">split</span><span class="pl-k">:</span> <span class="pl-c1">12</span>

          <span class="pl-smi">OOB</span> <span class="pl-smi">estimate</span> <span class="pl-smi">of</span>  <span class="pl-smi">error</span> <span class="pl-smi">rate</span><span class="pl-k">:</span> <span class="pl-c1">1.14</span>%
  <span class="pl-smi">Confusion</span> <span class="pl-smi">matrix</span><span class="pl-k">:</span>
       <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span> <span class="pl-smi">class.error</span>
  <span class="pl-smi">A</span> <span class="pl-c1">3335</span>    <span class="pl-c1">9</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.003882915</span>
  <span class="pl-smi">B</span>   <span class="pl-c1">24</span> <span class="pl-c1">2231</span>   <span class="pl-c1">24</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span> <span class="pl-c1">0.021061869</span>
  <span class="pl-smi">C</span>    <span class="pl-c1">0</span>   <span class="pl-c1">21</span> <span class="pl-c1">2017</span>   <span class="pl-c1">16</span>    <span class="pl-c1">0</span> <span class="pl-c1">0.018013632</span>
  <span class="pl-smi">D</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span>   <span class="pl-c1">18</span> <span class="pl-c1">1908</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.011398964</span>
  <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">1</span>    <span class="pl-c1">4</span>    <span class="pl-c1">9</span> <span class="pl-c1">2151</span> <span class="pl-c1">0.006466513</span></pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">testPred</span> <span class="pl-k">&lt;-</span> predict(<span class="pl-smi">modelFit2c</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">testData</span>)
  confusionMatrix(<span class="pl-smi">testData</span><span class="pl-k">$</span><span class="pl-smi">Classe</span>,<span class="pl-smi">testPred</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Confusion</span> <span class="pl-smi">Matrix</span> <span class="pl-smi">and</span> <span class="pl-smi">Statistics</span>

              <span class="pl-smi">Reference</span>
    <span class="pl-smi">Prediction</span>    <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span>
             <span class="pl-smi">A</span> <span class="pl-c1">2231</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">B</span>    <span class="pl-c1">7</span> <span class="pl-c1">1498</span>   <span class="pl-c1">13</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">C</span>    <span class="pl-c1">0</span>    <span class="pl-c1">4</span> <span class="pl-c1">1354</span>   <span class="pl-c1">10</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">D</span>    <span class="pl-c1">0</span>    <span class="pl-c1">2</span>   <span class="pl-c1">18</span> <span class="pl-c1">1263</span>    <span class="pl-c1">3</span>
             <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">1</span>    <span class="pl-c1">4</span>    <span class="pl-c1">3</span> <span class="pl-c1">1434</span>

    <span class="pl-smi">Overall</span> <span class="pl-smi">Statistics</span>

                   <span class="pl-smi">Accuracy</span> <span class="pl-k">:</span> <span class="pl-c1">0.9916</span>          
                     <span class="pl-c1">95</span>% <span class="pl-smi">CI</span> <span class="pl-k">:</span> (<span class="pl-c1">0.9893</span>, <span class="pl-c1">0.9935</span>)
        <span class="pl-smi">No</span> <span class="pl-smi">Information</span> <span class="pl-smi">Rate</span> <span class="pl-k">:</span> <span class="pl-c1">0.2852</span>          
        <span class="pl-smi">P</span><span class="pl-k">-</span><span class="pl-smi">Value</span> [<span class="pl-smi">Acc</span> <span class="pl-k">&gt;</span> <span class="pl-smi">NIR</span>] <span class="pl-k">:</span> <span class="pl-k">&lt;</span> <span class="pl-c1">2.2e-16</span>       

                      <span class="pl-smi">Kappa</span> <span class="pl-k">:</span> <span class="pl-c1">0.9894</span>          
     <span class="pl-smi">Mcnemar</span><span class="pl-s"><span class="pl-pds">'</span>s Test P-Value : NA              </span>
<span class="pl-s"></span>
<span class="pl-s">    Statistics by Class:</span>
<span class="pl-s"></span>
<span class="pl-s">                         Class: A Class: B Class: C Class: D Class: E</span>
<span class="pl-s">    Sensitivity            0.9969   0.9947   0.9748   0.9898   0.9979</span>
<span class="pl-s">    Specificity            0.9998   0.9968   0.9978   0.9965   0.9988</span>
<span class="pl-s">    Pos Pred Value         0.9996   0.9868   0.9898   0.9821   0.9945</span>
<span class="pl-s">    Neg Pred Value         0.9988   0.9987   0.9946   0.9980   0.9995</span>
<span class="pl-s">    Prevalence             0.2852   0.1919   0.1770   0.1626   0.1832</span>
<span class="pl-s">    Detection Rate         0.2843   0.1909   0.1726   0.1610   0.1828</span>
<span class="pl-s">    Detection Prevalence   0.2845   0.1935   0.1744   0.1639   0.1838</span>
<span class="pl-s">    Balanced Accuracy      0.9983   0.9958   0.9863   0.9932   0.9983</span></pre></div>

<p>Performing the same calculation but now using the original data set with 46 variables (no cutoff) and comparing with the original modelFit2, we can compare the effect of only 10-fold cross-validation (k=10).</p>

<div class="highlight highlight-source-r"><pre>    set.seed(<span class="pl-c1">10025</span>)
    <span class="pl-smi">fitControl</span> <span class="pl-k">&lt;-</span> trainControl( <span class="pl-v">method</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>cv<span class="pl-pds">"</span></span>, <span class="pl-v">number</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>)
    <span class="pl-smi">modelFit2f</span> <span class="pl-k">&lt;-</span> train(<span class="pl-smi">Classe</span> <span class="pl-k">~</span> ., <span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">trainData</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>, <span class="pl-v">trControl</span> <span class="pl-k">=</span> <span class="pl-smi">fitControl</span>)
    <span class="pl-smi">modelFit2f</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Random</span> <span class="pl-smi">Forest</span> 

    <span class="pl-c1">11776</span> <span class="pl-smi">samples</span>
       <span class="pl-c1">45</span> <span class="pl-smi">predictor</span>
        <span class="pl-c1">5</span> <span class="pl-smi">classes</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>E<span class="pl-pds">'</span></span> 

    <span class="pl-smi">No</span> <span class="pl-smi">pre</span><span class="pl-k">-</span><span class="pl-smi">processing</span>
    <span class="pl-smi">Resampling</span><span class="pl-k">:</span> <span class="pl-smi">Cross</span><span class="pl-k">-</span>Validated (<span class="pl-c1">10</span> <span class="pl-smi">fold</span>) 
    <span class="pl-smi">Summary</span> <span class="pl-smi">of</span> <span class="pl-smi">sample</span> <span class="pl-smi">sizes</span><span class="pl-k">:</span> <span class="pl-c1">10599</span>, <span class="pl-c1">10599</span>, <span class="pl-c1">10599</span>, <span class="pl-c1">10598</span>, <span class="pl-c1">10598</span>, <span class="pl-c1">10598</span>, <span class="pl-k">...</span> 
    <span class="pl-smi">Resampling</span> <span class="pl-smi">results</span> <span class="pl-smi">across</span> <span class="pl-smi">tuning</span> <span class="pl-smi">parameters</span><span class="pl-k">:</span>

      <span class="pl-smi">mtry</span>  <span class="pl-smi">Accuracy</span>   <span class="pl-smi">Kappa</span>    
       <span class="pl-c1">2</span>    <span class="pl-c1">0.9889613</span>  <span class="pl-c1">0.9860343</span>
      <span class="pl-c1">23</span>    <span class="pl-c1">0.9898949</span>  <span class="pl-c1">0.9872163</span>
      <span class="pl-c1">45</span>    <span class="pl-c1">0.9791109</span>  <span class="pl-c1">0.9735707</span>

    <span class="pl-smi">Accuracy</span> <span class="pl-smi">was</span> <span class="pl-smi">used</span> <span class="pl-smi">to</span> <span class="pl-smi">select</span> <span class="pl-smi">the</span> <span class="pl-smi">optimal</span> <span class="pl-smi">model</span> <span class="pl-smi">using</span>  <span class="pl-smi">the</span> <span class="pl-smi">largest</span> <span class="pl-smi">value</span>.
    <span class="pl-smi">The</span> <span class="pl-smi">final</span> <span class="pl-smi">value</span> <span class="pl-smi">used</span> <span class="pl-k">for</span> <span class="pl-smi">the</span> <span class="pl-smi">model</span> <span class="pl-smi">was</span> <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-c1">23</span>. </pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">modelFit2f</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Call</span><span class="pl-k">:</span>
     randomForest(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>, <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-smi">param</span><span class="pl-k">$</span><span class="pl-smi">mtry</span>) 
                   <span class="pl-smi">Type</span> <span class="pl-smi">of</span> <span class="pl-smi">random</span> <span class="pl-smi">forest</span><span class="pl-k">:</span> <span class="pl-smi">classification</span>
                         <span class="pl-smi">Number</span> <span class="pl-smi">of</span> <span class="pl-smi">trees</span><span class="pl-k">:</span> <span class="pl-c1">500</span>
    <span class="pl-smi">No</span>. <span class="pl-smi">of</span> <span class="pl-smi">variables</span> <span class="pl-smi">tried</span> <span class="pl-smi">at</span> <span class="pl-smi">each</span> <span class="pl-smi">split</span><span class="pl-k">:</span> <span class="pl-c1">23</span>

            <span class="pl-smi">OOB</span> <span class="pl-smi">estimate</span> <span class="pl-smi">of</span>  <span class="pl-smi">error</span> <span class="pl-smi">rate</span><span class="pl-k">:</span> <span class="pl-c1">0.86</span>%
    <span class="pl-smi">Confusion</span> <span class="pl-smi">matrix</span><span class="pl-k">:</span>
         <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span> <span class="pl-smi">class.error</span>
    <span class="pl-smi">A</span> <span class="pl-c1">3340</span>    <span class="pl-c1">5</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.002389486</span>
    <span class="pl-smi">B</span>   <span class="pl-c1">23</span> <span class="pl-c1">2244</span>   <span class="pl-c1">11</span>    <span class="pl-c1">0</span>    <span class="pl-c1">1</span> <span class="pl-c1">0.015357613</span>
    <span class="pl-smi">C</span>    <span class="pl-c1">0</span>   <span class="pl-c1">14</span> <span class="pl-c1">2031</span>    <span class="pl-c1">9</span>    <span class="pl-c1">0</span> <span class="pl-c1">0.011197663</span>
    <span class="pl-smi">D</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span>   <span class="pl-c1">23</span> <span class="pl-c1">1904</span>    <span class="pl-c1">1</span> <span class="pl-c1">0.013471503</span>
    <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">2</span>    <span class="pl-c1">7</span> <span class="pl-c1">2156</span> <span class="pl-c1">0.004157044</span></pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">testPred</span> <span class="pl-k">&lt;-</span> predict(<span class="pl-smi">modelFit2f</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">testData</span>)
    confusionMatrix(<span class="pl-smi">testData</span><span class="pl-k">$</span><span class="pl-smi">Classe</span>,<span class="pl-smi">testPred</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>    <span class="pl-smi">Confusion</span> <span class="pl-smi">Matrix</span> <span class="pl-smi">and</span> <span class="pl-smi">Statistics</span>

              <span class="pl-smi">Reference</span>
    <span class="pl-smi">Prediction</span>    <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span>
             <span class="pl-smi">A</span> <span class="pl-c1">2232</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">B</span>    <span class="pl-c1">6</span> <span class="pl-c1">1503</span>    <span class="pl-c1">9</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">C</span>    <span class="pl-c1">0</span>    <span class="pl-c1">5</span> <span class="pl-c1">1362</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">D</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>   <span class="pl-c1">24</span> <span class="pl-c1">1260</span>    <span class="pl-c1">2</span>
             <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">3</span>    <span class="pl-c1">5</span> <span class="pl-c1">1434</span>

    <span class="pl-smi">Overall</span> <span class="pl-smi">Statistics</span>

                   <span class="pl-smi">Accuracy</span> <span class="pl-k">:</span> <span class="pl-c1">0.993</span>           
                     <span class="pl-c1">95</span>% <span class="pl-smi">CI</span> <span class="pl-k">:</span> (<span class="pl-c1">0.9909</span>, <span class="pl-c1">0.9947</span>)
        <span class="pl-smi">No</span> <span class="pl-smi">Information</span> <span class="pl-smi">Rate</span> <span class="pl-k">:</span> <span class="pl-c1">0.2852</span>          
        <span class="pl-smi">P</span><span class="pl-k">-</span><span class="pl-smi">Value</span> [<span class="pl-smi">Acc</span> <span class="pl-k">&gt;</span> <span class="pl-smi">NIR</span>] <span class="pl-k">:</span> <span class="pl-k">&lt;</span> <span class="pl-c1">2.2e-16</span>       

                      <span class="pl-smi">Kappa</span> <span class="pl-k">:</span> <span class="pl-c1">0.9911</span>          
     <span class="pl-smi">Mcnemar</span><span class="pl-s"><span class="pl-pds">'</span>s Test P-Value : NA              </span>
<span class="pl-s"></span>
<span class="pl-s">    Statistics by Class:</span>
<span class="pl-s"></span>
<span class="pl-s">                         Class: A Class: B Class: C Class: D Class: E</span>
<span class="pl-s">    Sensitivity            0.9973   0.9967   0.9742   0.9953   0.9986</span>
<span class="pl-s">    Specificity            1.0000   0.9976   0.9991   0.9960   0.9988</span>
<span class="pl-s">    Pos Pred Value         1.0000   0.9901   0.9956   0.9798   0.9945</span>
<span class="pl-s">    Neg Pred Value         0.9989   0.9992   0.9944   0.9991   0.9997</span>
<span class="pl-s">    Prevalence             0.2852   0.1922   0.1782   0.1614   0.1830</span>
<span class="pl-s">    Detection Rate         0.2845   0.1916   0.1736   0.1606   0.1828</span>
<span class="pl-s">    Detection Prevalence   0.2845   0.1935   0.1744   0.1639   0.1838</span>
<span class="pl-s">    Balanced Accuracy      0.9987   0.9972   0.9867   0.9957   0.9987</span></pre></div>

<p>This result is very welcoming because the accuracy is very similar to modelFit2 but the OOB error rate is small (0.86% vs 0.91%). But the most relevant is the modelling time. The CV resampling reduced the time from 5 hours to 30 minutes!</p>

<ol>
<li>Change the number of trees</li>
</ol>

<p>We can obtain the relationship model error of classification and number of trees in the "Random Forest" model. For instance, the model modelFit2c (10-fold cross-validation with importance variable cutoff 10%) has the error related to the number of trees shown in Figure 3:</p>

<div class="highlight highlight-source-r"><pre>    library(<span class="pl-smi">reshape</span>)
    <span class="pl-smi">df.melted</span> <span class="pl-k">&lt;-</span> melt(<span class="pl-smi">modelFit2c</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span><span class="pl-k">$</span><span class="pl-smi">err.rate</span>, <span class="pl-v">id</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ntree<span class="pl-pds">"</span></span>)
    names(<span class="pl-smi">df.melted</span>) <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">'</span>ntree<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>Classe<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>Error<span class="pl-pds">'</span></span>)
    ggplot(<span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">df.melted</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">ntree</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">Error</span>, <span class="pl-v">color</span> <span class="pl-k">=</span> <span class="pl-smi">Classe</span>)) 
    <span class="pl-k">+</span>   geom_line(<span class="pl-v">size</span><span class="pl-k">=</span><span class="pl-c1">1</span>)</pre></div>

<p></p><p align="center">
  <img src="https://raw.githubusercontent.com/anonymous-1618/ML/master/Fig3.png">
  <b>Figure 3 - </b>Random Forest Model Error per #tree<br>
  </p>

<p>We can see in Figure 3 that the error in all of them stabilised early than ntree=500 (default). So, by trying a model fit with ntree=200, we have:</p>

<div class="highlight highlight-source-r"><pre>  set.seed(<span class="pl-c1">2825</span>)
  <span class="pl-smi">fitControl</span> <span class="pl-k">&lt;-</span> trainControl( <span class="pl-v">method</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>cv<span class="pl-pds">"</span></span>, <span class="pl-v">number</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>)
  <span class="pl-smi">modelFit2b</span> <span class="pl-k">&lt;-</span> train(<span class="pl-smi">Classe</span> <span class="pl-k">~</span> ., <span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">trainDataImp</span>, <span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>, <span class="pl-v">ntree</span><span class="pl-k">=</span><span class="pl-c1">200</span>, <span class="pl-v">trControl</span> <span class="pl-k">=</span> <span class="pl-smi">fitControl</span>)
  <span class="pl-smi">modelFit2b</span></pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">Random</span> <span class="pl-smi">Forest</span> 

  <span class="pl-c1">11776</span> <span class="pl-smi">samples</span>
     <span class="pl-c1">23</span> <span class="pl-smi">predictor</span>
      <span class="pl-c1">5</span> <span class="pl-smi">classes</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>E<span class="pl-pds">'</span></span> 

  <span class="pl-smi">No</span> <span class="pl-smi">pre</span><span class="pl-k">-</span><span class="pl-smi">processing</span>
  <span class="pl-smi">Resampling</span><span class="pl-k">:</span> <span class="pl-smi">Cross</span><span class="pl-k">-</span>Validated (<span class="pl-c1">10</span> <span class="pl-smi">fold</span>) 
  <span class="pl-smi">Summary</span> <span class="pl-smi">of</span> <span class="pl-smi">sample</span> <span class="pl-smi">sizes</span><span class="pl-k">:</span> <span class="pl-c1">10598</span>, <span class="pl-c1">10599</span>, <span class="pl-c1">10599</span>, <span class="pl-c1">10597</span>, <span class="pl-c1">10598</span>, <span class="pl-c1">10598</span>, <span class="pl-k">...</span> 
  <span class="pl-smi">Resampling</span> <span class="pl-smi">results</span> <span class="pl-smi">across</span> <span class="pl-smi">tuning</span> <span class="pl-smi">parameters</span><span class="pl-k">:</span>

    <span class="pl-smi">mtry</span>  <span class="pl-smi">Accuracy</span>   <span class="pl-smi">Kappa</span>    
     <span class="pl-c1">2</span>    <span class="pl-c1">0.9866676</span>  <span class="pl-c1">0.9831335</span>
    <span class="pl-c1">12</span>    <span class="pl-c1">0.9871779</span>  <span class="pl-c1">0.9837805</span>
    <span class="pl-c1">23</span>    <span class="pl-c1">0.9774111</span>  <span class="pl-c1">0.9714243</span>

  <span class="pl-smi">Accuracy</span> <span class="pl-smi">was</span> <span class="pl-smi">used</span> <span class="pl-smi">to</span> <span class="pl-smi">select</span> <span class="pl-smi">the</span> <span class="pl-smi">optimal</span> <span class="pl-smi">model</span> <span class="pl-smi">using</span>  <span class="pl-smi">the</span> <span class="pl-smi">largest</span> <span class="pl-smi">value</span>.
  <span class="pl-smi">The</span> <span class="pl-smi">final</span> <span class="pl-smi">value</span> <span class="pl-smi">used</span> <span class="pl-k">for</span> <span class="pl-smi">the</span> <span class="pl-smi">model</span> <span class="pl-smi">was</span> <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-c1">12</span>. </pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">modelFit2b</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span></pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">Call</span><span class="pl-k">:</span>
  randomForest(<span class="pl-v">x</span> <span class="pl-k">=</span> <span class="pl-smi">x</span>, <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">y</span>, <span class="pl-v">ntree</span> <span class="pl-k">=</span> <span class="pl-c1">200</span>, <span class="pl-v">mtry</span> <span class="pl-k">=</span> <span class="pl-smi">param</span><span class="pl-k">$</span><span class="pl-smi">mtry</span>) 
               <span class="pl-smi">Type</span> <span class="pl-smi">of</span> <span class="pl-smi">random</span> <span class="pl-smi">forest</span><span class="pl-k">:</span> <span class="pl-smi">classification</span>
                       <span class="pl-smi">Number</span> <span class="pl-smi">of</span> <span class="pl-smi">trees</span><span class="pl-k">:</span> <span class="pl-c1">200</span>
  <span class="pl-smi">No</span>. <span class="pl-smi">of</span> <span class="pl-smi">variables</span> <span class="pl-smi">tried</span> <span class="pl-smi">at</span> <span class="pl-smi">each</span> <span class="pl-smi">split</span><span class="pl-k">:</span> <span class="pl-c1">12</span>

          <span class="pl-smi">OOB</span> <span class="pl-smi">estimate</span> <span class="pl-smi">of</span>  <span class="pl-smi">error</span> <span class="pl-smi">rate</span><span class="pl-k">:</span> <span class="pl-c1">1.26</span>%
  <span class="pl-smi">Confusion</span> <span class="pl-smi">matrix</span><span class="pl-k">:</span>
       <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span> <span class="pl-smi">class.error</span>
  <span class="pl-smi">A</span> <span class="pl-c1">3328</span>   <span class="pl-c1">14</span>    <span class="pl-c1">2</span>    <span class="pl-c1">2</span>    <span class="pl-c1">2</span> <span class="pl-c1">0.005973716</span>
  <span class="pl-smi">B</span>   <span class="pl-c1">24</span> <span class="pl-c1">2230</span>   <span class="pl-c1">23</span>    <span class="pl-c1">1</span>    <span class="pl-c1">1</span> <span class="pl-c1">0.021500658</span>
  <span class="pl-smi">C</span>    <span class="pl-c1">0</span>   <span class="pl-c1">20</span> <span class="pl-c1">2016</span>   <span class="pl-c1">18</span>    <span class="pl-c1">0</span> <span class="pl-c1">0.018500487</span>
  <span class="pl-smi">D</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>   <span class="pl-c1">20</span> <span class="pl-c1">1902</span>    <span class="pl-c1">7</span> <span class="pl-c1">0.014507772</span>
  <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">3</span>   <span class="pl-c1">10</span> <span class="pl-c1">2152</span> <span class="pl-c1">0.006004619</span></pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">testPred</span> <span class="pl-k">&lt;-</span> predict(<span class="pl-smi">modelFit2b</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">testData</span>)
  confusionMatrix(<span class="pl-smi">testData</span><span class="pl-k">$</span><span class="pl-smi">Classe</span>,<span class="pl-smi">testPred</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>  <span class="pl-smi">Confusion</span> <span class="pl-smi">Matrix</span> <span class="pl-smi">and</span> <span class="pl-smi">Statistics</span>

              <span class="pl-smi">Reference</span>
    <span class="pl-smi">Prediction</span>    <span class="pl-smi">A</span>    <span class="pl-smi">B</span>    <span class="pl-smi">C</span>    <span class="pl-smi">D</span>    <span class="pl-smi">E</span>
             <span class="pl-smi">A</span> <span class="pl-c1">2230</span>    <span class="pl-c1">2</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">B</span>    <span class="pl-c1">6</span> <span class="pl-c1">1495</span>   <span class="pl-c1">16</span>    <span class="pl-c1">1</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">C</span>    <span class="pl-c1">0</span>    <span class="pl-c1">4</span> <span class="pl-c1">1354</span>   <span class="pl-c1">10</span>    <span class="pl-c1">0</span>
             <span class="pl-smi">D</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>   <span class="pl-c1">20</span> <span class="pl-c1">1263</span>    <span class="pl-c1">3</span>
             <span class="pl-smi">E</span>    <span class="pl-c1">0</span>    <span class="pl-c1">0</span>    <span class="pl-c1">5</span>    <span class="pl-c1">5</span> <span class="pl-c1">1432</span>

    <span class="pl-smi">Overall</span> <span class="pl-smi">Statistics</span>

                   <span class="pl-smi">Accuracy</span> <span class="pl-k">:</span> <span class="pl-c1">0.9908</span>          
                     <span class="pl-c1">95</span>% <span class="pl-smi">CI</span> <span class="pl-k">:</span> (<span class="pl-c1">0.9885</span>, <span class="pl-c1">0.9928</span>)
        <span class="pl-smi">No</span> <span class="pl-smi">Information</span> <span class="pl-smi">Rate</span> <span class="pl-k">:</span> <span class="pl-c1">0.285</span>           
        <span class="pl-smi">P</span><span class="pl-k">-</span><span class="pl-smi">Value</span> [<span class="pl-smi">Acc</span> <span class="pl-k">&gt;</span> <span class="pl-smi">NIR</span>] <span class="pl-k">:</span> <span class="pl-k">&lt;</span> <span class="pl-c1">2.2e-16</span>       

                      <span class="pl-smi">Kappa</span> <span class="pl-k">:</span> <span class="pl-c1">0.9884</span>          
     <span class="pl-smi">Mcnemar</span><span class="pl-s"><span class="pl-pds">'</span>s Test P-Value : NA              </span>
<span class="pl-s"></span>
<span class="pl-s">    Statistics by Class:</span>
<span class="pl-s"></span>
<span class="pl-s">                         Class: A Class: B Class: C Class: D Class: E</span>
<span class="pl-s">    Sensitivity            0.9973   0.9960   0.9706   0.9875   0.9979</span>
<span class="pl-s">    Specificity            0.9996   0.9964   0.9978   0.9965   0.9984</span>
<span class="pl-s">    Pos Pred Value         0.9991   0.9848   0.9898   0.9821   0.9931</span>
<span class="pl-s">    Neg Pred Value         0.9989   0.9991   0.9937   0.9976   0.9995</span>
<span class="pl-s">    Prevalence             0.2850   0.1913   0.1778   0.1630   0.1829</span>
<span class="pl-s">    Detection Rate         0.2842   0.1905   0.1726   0.1610   0.1825</span>
<span class="pl-s">    Detection Prevalence   0.2845   0.1935   0.1744   0.1639   0.1838</span>
<span class="pl-s">    Balanced Accuracy      0.9985   0.9962   0.9842   0.9920   0.9982</span></pre></div>

<p>The accuracy did not change by much, but the OOB error rate was the highest of all the evaluated models (1.26%). On the other hand, it was the fitted model that took less time (~ 6 minutes). </p>

<h3>
<a id="predicting-the-20-test-cases" class="anchor" href="#predicting-the-20-test-cases" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Predicting the 20 test cases:</h3>

<p>After tidying up the test data set (pml.testing), we can estimate the exercise Classe of each one of the 20 test cases.</p>

<div class="highlight highlight-source-r"><pre>  <span class="pl-v">temp</span><span class="pl-k">=</span>names(<span class="pl-smi">pml.testing</span>)
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^a<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^g<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>G<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); 
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^k<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>K<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^m<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>M<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^n<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>N<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^p<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>P<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^r<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>R<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^s<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>S<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^t<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>T<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^u<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>U<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^v<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>V<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>^y<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Y<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_a<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_b<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>B<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>C<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_d<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>D<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_f<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>F<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_g<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>G<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_k<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>K<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_m<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>M<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_n<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>N<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_p<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>P<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_r<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>R<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_s<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>S<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_t<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>T<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_u<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>U<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_v<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>V<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_x<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_y<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Y<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_w<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>W<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_z<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Z<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_1<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>); <span class="pl-v">temp</span><span class="pl-k">=</span>gsub(<span class="pl-s"><span class="pl-pds">"</span>_2<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span>,<span class="pl-smi">temp</span>);
  <span class="pl-v">TidyDataTest</span> <span class="pl-k">=</span> <span class="pl-smi">pml.testing</span>
  colnames(<span class="pl-smi">TidyDataTest</span>) <span class="pl-k">=</span> <span class="pl-smi">tempt</span>
  <span class="pl-v">NewTidyDataTest</span> <span class="pl-k">=</span> <span class="pl-smi">TidyDataTest</span>[, colSums(is.na(<span class="pl-smi">TidyDataTest</span>))<span class="pl-k">/</span>nrow(<span class="pl-smi">TidyDataTest</span>) <span class="pl-k">&lt;</span> <span class="pl-c1">0.95</span>]
  dim(<span class="pl-smi">NewTidyDataTest</span>)</pre></div>

<div class="highlight highlight-source-r"><pre>  [<span class="pl-c1">1</span>] <span class="pl-c1">20</span> <span class="pl-c1">60</span></pre></div>

<div class="highlight highlight-source-r"><pre>  library(<span class="pl-smi">dplyr</span>)
  <span class="pl-v">CaseDataTest</span> <span class="pl-k">=</span> select(<span class="pl-smi">NewTidyDataTest</span>,<span class="pl-k">-</span>c(<span class="pl-smi">X</span><span class="pl-k">:</span><span class="pl-smi">NumWindow</span>))
  dim(<span class="pl-smi">CaseDataTest</span>)
  [<span class="pl-c1">1</span>] <span class="pl-c1">20</span> <span class="pl-c1">53</span></pre></div>

<div class="highlight highlight-source-r"><pre>  predict(<span class="pl-smi">modelFit2</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">CaseDataTest</span>)</pre></div>

<div class="highlight highlight-source-r"><pre> [<span class="pl-c1">1</span>] <span class="pl-smi">B</span> <span class="pl-smi">A</span> <span class="pl-smi">B</span> <span class="pl-smi">A</span> <span class="pl-smi">A</span> <span class="pl-smi">E</span> <span class="pl-smi">D</span> <span class="pl-smi">B</span> <span class="pl-smi">A</span> <span class="pl-smi">A</span> <span class="pl-smi">B</span> <span class="pl-smi">C</span> <span class="pl-smi">B</span> <span class="pl-smi">A</span> <span class="pl-smi">E</span> <span class="pl-smi">E</span> <span class="pl-smi">A</span> <span class="pl-smi">B</span> <span class="pl-smi">B</span> <span class="pl-smi">B</span>
<span class="pl-smi">Levels</span><span class="pl-k">:</span> <span class="pl-smi">A</span> <span class="pl-smi">B</span> <span class="pl-smi">C</span> <span class="pl-smi">D</span> <span class="pl-smi">E</span></pre></div>

<p>I have also evaluated the other 4 models:  modelFit2a, modelFit2b, modelFit2c and modelFit2f. These models presented slightly different inaccuracies and as expected, all gave the same results.</p>

<h3>
<a id="conclusions" class="anchor" href="#conclusions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusions:</h3>

<p>In this report, how to download the data is shown and also how to review it by analysing the data structure. The data was also tidied up and reorganised for better variable description (CamelCase). Correlations between the variables to reduce the model complexity were performed. The main assumptions made for the proposed model is to be person-independent and time-independent. The initial 160 variables were reduced to 46. Final models show that only 12 predictors could be used. Also, how to build a Machine Learning Model by using <em>caret</em> package was shown, along with how the parameters in the <code>train()</code> function can affect the model accuracy and fitting time. For instance, k-fold cross validation gave similar results in terms of accuracy but the modelling of the training set was much faster than by using boostrap resampling. In all the cases, the number of predictors used in the final model was the same, that is, 23. The best sample error obtained was 0.68% with the original model. Finally, by using the Random Forest method, all the models in this work predict the same result in the 20 test cases, that is:</p>

<div class="highlight highlight-source-r"><pre>  table(predict(<span class="pl-smi">modelFit2f</span>, <span class="pl-v">newdata</span> <span class="pl-k">=</span> <span class="pl-smi">CaseDataTest</span>))</pre></div>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">A</span> <span class="pl-smi">B</span> <span class="pl-smi">C</span> <span class="pl-smi">D</span> <span class="pl-smi">E</span> 
<span class="pl-c1">7</span> <span class="pl-c1">8</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">3</span> </pre></div>

<p>Only 7 out of 20 shows the right way to perform the dumbbell lifting exercise.</p>

<hr>

<h4>
<a id="reference" class="anchor" href="#reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reference:</h4>

<p><a href="https://perceptual.mpi-inf.mpg.de/files/2013/03/velloso13_ah.pdf">https://perceptual.mpi-inf.mpg.de/files/2013/03/velloso13_ah.pdf</a></p>

<p><a href="https://www.sparkfun.com/products/10736">https://www.sparkfun.com/products/10736</a></p>

<p><a href="http://web.ipac.caltech.edu/staff/fmasci/home/astro_refs/BuildingPredictiveModelsR_caret.pdf">http://web.ipac.caltech.edu/staff/fmasci/home/astro_refs/BuildingPredictiveModelsR_caret.pdf</a></p>

<p><a href="http://topepo.github.io/caret/training.html">http://topepo.github.io/caret/training.html</a></p>

<p><a href="http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram">http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram</a></p>

<p><a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#hr">https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#hr</a></p>

<p><a href="http://hplgit.github.io/teamods/bitgit/html-github/._main_bitgit002.html">http://hplgit.github.io/teamods/bitgit/html-github/._main_bitgit002.html</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/anonymous-1618/ML">Practical Machine Learning Course</a> is maintained by <a href="https://github.com/anonymous-1618">anonymous-1618</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
